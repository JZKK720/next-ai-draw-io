services:
  drawio:
    image: jgraph/drawio:latest
    ports: ["8231:8080"]
  next-ai-draw-io:
    build:
      context: .
      args:
        # Use DRAWIO_BASE_URL env var (defaults to localhost for local dev)
        # Set to your domain when hosting: e.g., https://your-domain.com:8231 or https://your-domain.com/drawio
        - NEXT_PUBLIC_DRAWIO_BASE_URL=${DRAWIO_BASE_URL:-http://localhost:8231}
        # For subdirectory deployment, set NEXT_PUBLIC_BASE_PATH env var
        # e.g., /nextaidrawio
        - NEXT_PUBLIC_BASE_PATH=${NEXT_PUBLIC_BASE_PATH:-}
    ports: ["3201:3000"]
    env_file: .env
    environment:
      # Optional: Override build-time env vars
      NEXT_PUBLIC_DRAWIO_BASE_URL: ${DRAWIO_BASE_URL:-http://localhost:8231}
    depends_on: [drawio]
